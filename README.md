# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Данные и типы данных

Данные приложения
```
interface IAppData {
    catalog: IProduct[]
    basket: IProduct[]
    order: IOrder | null
    preview: string | null
    loading: boolean;
}
```
Страница
```
interface IPage {
    counter: number
    catalog: HTMLElement[]
    locked: boolean
}
```
Данные модального окна
```
interface IModalData {
    content: HTMLElement
}
```
Форма
```
interface IFormState {
    valid: boolean
    errors: string[]
}
```

Продукт
```
interface IProduct {
    id: string,
    description: string,
    image: string,
    title: string,
    category: string,
    price: number | null
}
```
Корзина
```
interface IBasket {
    items: HTMLElement[]
    total: number
}
```
Контакты
```
interface IContacts {
    email: string
    phone: string
}
```
Заказ товара
```
interface IOrder extends IContacts {
    payment: number,
    address: string,
    total: number,
    items: string[]
}
```
Результат заказа
```
interface IOrderResult {
    id: string,
    total: number 
}
```
Успешный заказ
```
interface ISuccess {
    total: number; 
}
```
Результат успешного заказа
```
interface ISuccessActions {
    onClick: () => void;
}
```
Интерфейс для API
```
export interface ILarekApi {
    getProducts: () => Promise<IProduct[]>
    getProduct: (id: string) => Promise<IProduct>
    createOrder: (order: IOrder) => Promise<IOrderResult>
  }
```

Тип данных товара в корзине 
```
type TProductBakets = Pick<IProduct, 'id' | 'title' | 'price'>
```

Тип данных ошибок валидации форм
```
type TFormErrors = Partial<Record<keyof IOrder, string>>
 ```   

## Архитектура проекта

Код прилолжения разделен на части MVP парадигмы

* Слой модель данных для пользовательского интерфейса
* Слой представление показывает пользователю интерфейс
* Слой презентер управляет моделью и представлением

## Базовый код

### Класс Component
Класс **Component** является родителем для других класов представления.

Методы:

* `toggleClass` - Переключает классы элемента
* `setText` - Устанавливает текстовое содержимое
* `setDisabled` - Меняет состояние блокировки. Устанавливает если его нет, убирает если оно есть
* `setHidden` - Скрывает элемент
* `setVisible` - Показывает элемент
* `setImage` - устанавливает изображение
* `render` - заполняет элемент данными


### Кдасс EventEmitter

Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков
о наступлении события.

Методы класса EventEmitter:

* `on` - устанавливает оброботчик событий
* `off` - снимает обработчик событий
* `emit` - инициировать событие с данными
* `onAll` - устанавливает все оброботчики событий 
* `offAll` - снимает все обработчики событий


### Класс Api
Класс Api реализует запросы на сервер

Методы класа Api:
* `get` - отправляет GET запрос на сервер и возвращает промис
* `post` - принимает обьект с данными json и отправляет запрос на сервер

## Cлой данных

### Класс Model
Класс **Model** является базовым классом для работы с моделью данных

Методы:

* `emitChanges` - сообщает всем что модель изменилась

### Класс ProductItem
Класс **ProductItem** является моделью данных товара он содержит в себе информацию\
товара и является наследником базового класса **Modal**.

### Класс AppData
Класс **AppData** является дочерним классом **Model**. \
Основная суть класса **AppData** содержать в себе функционал для определенных\
действий на странице.

Методы:

* `addProductBasket` - добавление товара в корзину
* `removeProductBasket` - удаление товара из корзины
* `clearBasket` - очистка корзины
* `clearOrder` - очистка текущего заказа
* `getTotal` - выводит общую сумму заказа
* `setCatalog` - установка каталога товаров
* `setPreview` - установка для предпросмотра товара
* `validateOrder` - валидация форм заказа

### Класс LarekApi
Класс **LarekApi** отвечает за получение католога с товарами и оформление заказа\
товара.

Методы:

* `getProducts` - отправляет запрос на получение списка всех товаров
* `getProduct` - отправляет запрос на получение информации товара с указанным id 
* `createOrder` - отправляет запрос для оформления заказа с указанными данными

## Слой представления

### Класс Modal
Класс **Modal** отвечвет за открытие и закрытие всех модальных окон на странице.

Поля:

 * `_closeButton` - кнопка закрытия модального окна
 * `_content`  - содержимое модального окна

Методы:

* `open` - открывает модальное окно
* `close` - закрывает модальное окно
* `render` - рендеринг модалки

### Класс Basket
Класс **Basket** выполняет роль хранения товара перед покупкой.

Поля:

* `_list` - список товаров в корзине
* `_total` - общая сумма заказа
* `_button` - кнопка для перехода к оформлению заказа 

Использование сеттеров:

* `items` - Устанавливает Html элемент в корзину
* `total` - Устанавливает общию сумму товаров в корзине 



### Класс Form
Класс **Form** отвечает за работу с формами.

Поля:

* `_submit` - кнопка продолжение оформление заказа
* `_errors` - элемент отображение ошибок формы

Методы:

* `onInputChange` - метод обработки изменения поля ввода
* `render` - рендеринг формы

Использование сеттеров:

* `valid` - установка валидности формы
* `errors` - установка ошибок валидации


### Класс Success
Класс **Success** уведомляет о успешном заказа.

Поля: 

* `_close` - кнопка закрытия модального окна успешная покупка
* `_total` - элемент отображения цены заказа

Использование ссетера `total` для установки суммы заказаного товара в модальном окне.

### Класс Page
Класс **Page** отвечает за отображение страницы.

Поля:

* `_counter` - cчетчик корзины
* `_catalog` - каталог с товарами
* `_wrapper` - обвертка страницы
* `_basket` - корзина

Использование сеттеров:

* `counter` - установка количества товаров в корзине
* `catalog` - установка содержимого каталога
* `locked` - установка блокировки страницы


### Класс CardProduct
Класс **CardProduct** отвечает за отображение карточки товара на странице.

Поля: 

* `_title` - Заголовок продукта
* `_image` - Изображение товара
* `_category` - категория товара
* `_description` - описание товара
* `_price` - цена товара


Методы:

### Класс CardProductBasket
 Класс **CardProductBasket** отвечает за отображение товара в корзине.

 Поля:

 * `_index` - нумерация товара в корзине
 * `_title` - название товара
 * `_price` - цена товара
 * `_button` - кнопка удаления товара из корзины

Использование сеттеров:
* `index` - установка номера товара с корзине
* `title` - установка названия товара
* `price` - установка цены товара


### Класс Address
Класс **Address** отвечает за работу с формой выбора доставки.

Поля:

* `_buttonOnline` - способ оплаты онлайн
* `_buttonUponReceipt` - способ оплаты при получении
* `_address` - поле для указания адреса доставки


Методы:

### Класс Contacts
Класс **Contacts** отвечает за работу формой с контактами.

Поля:

* `_phone` - поле для указания номера
* `_email` - поле для указания электроной почты

Использование сеттеров:

* `phone` - Установка номера
* `email` - Установка электроной почты

## Слой представитель

За слой представителя отвечает файл `src/index.js` внутри которого взаимодействуют представления и данные между собой. 